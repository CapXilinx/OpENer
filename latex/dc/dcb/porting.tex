\hypertarget{dc/dcb/porting_gen_config_section}{}\section{\-General Stack Configuration}\label{dc/dcb/porting_gen_config_section}
\-The general stack properties have to be defined prior to building your production. \-This is done by providing a file called opener\-\_\-user\-\_\-conf.\-h. \-An example file can be found in the src/ports/platform-\/pc directory. \-The documentation of the example file for the necessary configuration options\-: opener\-\_\-user\-\_\-conf.\-h

\hypertarget{dc/dcb/porting_startup_sec}{}\section{\-Startup Sequence}\label{dc/dcb/porting_startup_sec}
\-During startup of your \-Ether\-Net/\-I\-P(\-T\-M) device the following steps have to be performed\-:
\begin{DoxyEnumerate}
\item \-Configure the network properties\-:\par
 \-With the following functions the network interface of \-Op\-E\-Ner is configured\-:
\begin{DoxyItemize}
\item \-E\-I\-P\-\_\-\-S\-T\-A\-T\-U\-S \-Configure\-Network\-Interface(const char $\ast$ip\-\_\-address, const char $\ast$subnet\-\_\-mask, const char $\ast$gateway\-\_\-address)
\item void \-Configure\-M\-A\-C\-Address(const E\-I\-P\-\_\-\-U\-I\-N\-T8 $\ast$mac\-\_\-address)
\item void \-Configure\-Domain\-Name(const char $\ast$domain\-\_\-name)
\item void \-Configure\-Host\-Name(const char $\ast$host\-\_\-name)
\end{DoxyItemize}\-Depending on your platform these data can come from a configuration file or from operating system functions. \-If these values should be setable remotely via explicit messages the \-Set\-Attribute\-Single functions of the \-Ether\-Net\-Link and the \-T\-C\-P\-I\-P\-Interface object have to be adapted.
\item \-Set the device's serial number\par
 \-According to the \-C\-I\-P specification a device vendor has to ensure that each of its devices has a unique 32\-Bit device id. \-You can set it with the function\-:
\begin{DoxyItemize}
\item void set\-Device\-Serial\-Number(\-E\-I\-P\-\_\-\-U\-I\-N\-T32 serial\-\_\-number)
\end{DoxyItemize}
\item \-Initialize \-Op\-E\-Ner\-: \par
 \-With the function \-Cip\-Stack\-Init(\-E\-I\-P\-\_\-\-U\-I\-N\-T16 unique\-\_\-connection\-\_\-id) the internal data structures of opener are correctly setup. \-After this step own \-C\-I\-P objects and \-Assembly objects instances may be created. \-For your convenience we provide the call-\/back function \-Application\-Initialization. \-This call back function is called when the stack is ready to receive application specific \-C\-I\-P objects.
\item \-Create \-Application \-Specific \-C\-I\-P \-Objects\-:\par
 \-Within the call-\/back function \hyperlink{group__CIP__CALLBACK__API_gae93106eb1647bff3ad56a7752799d878}{\-Application\-Initialization(void)} or after \-Cip\-Stack\-Init(void) has finished you may create and configure any \-C\-I\-P object or \-Assembly object instances. \-See the module \hyperlink{group__CIP__API}{\-Op\-E\-Ner \-User interface} for available functions. \-Currently no functions are available to remove any created objects or instances. \-This is planned for future versions.
\item \-Setup the listening \-T\-C\-P and \-U\-D\-P port\-:\par
 \-T\-H\-E \-E\-T\-H\-E\-R\-N\-E\-T/\-I\-P \-S\-P\-E\-C\-I\-F\-I\-C\-A\-T\-I\-O\-N demands from devices to listen to \-T\-C\-P connections and \-U\-D\-P datagrams on the port \-A\-F12hex for explicit messages. \-Therefore before going into normal operation you need to configure your network library so that \-T\-C\-P and \-U\-D\-P messages on this port will be received and can be hand over to the \-Ethernet encapsulation layer.
\end{DoxyEnumerate}\hypertarget{dc/dcb/porting_normal_op_sec}{}\section{\-Normal Operation}\label{dc/dcb/porting_normal_op_sec}
\-During normal operation the following tasks have to be done by the platform specific code\-:
\begin{DoxyItemize}
\item \-Establish connections requested on \-T\-C\-P port \-A\-F12hex
\item \-Receive explicit message data on connected \-T\-C\-P sockets and the \-U\-P\-D socket for port \-A\-F12hex. \-The received data has to be hand over to \-Ethernet encapsulation layer with the functions\-: \par
 int \-Handle\-Received\-Explict\-T\-C\-P\-Data(int socket\-\_\-handle, \-E\-I\-P\-\_\-\-U\-I\-N\-T8$\ast$ buffer, int buffer\-\_\-length, int $\ast$number\-\_\-of\-\_\-remaining\-\_\-bytes),\par
 int \-Handle\-Received\-Explict\-U\-D\-P\-Data(int socket\-\_\-handle, struct sockaddr\-\_\-in $\ast$from\-\_\-address, \-E\-I\-P\-\_\-\-U\-I\-N\-T8$\ast$ buffer, unsigned int buffer\-\_\-length, int $\ast$number\-\_\-of\-\_\-remaining\-\_\-bytes).\par
 \-Depending if the data has been received from a \-T\-C\-P or from a \-U\-D\-P socket. \-As a result of this function a response may have to be sent. \-The data to be sent is in the given buffer pa\-\_\-buf.
\item \-Create \-U\-D\-P sending and receiving sockets for implicit connected messages\par
 \-Op\-E\-Ner will use to call-\/back function int \-Create\-Udp\-Socket( \-Udp\-Communcation\-Direction connection\-\_\-direction, struct sockaddr\-\_\-in $\ast$pa\-\_\-pst\-Addr) for informing the platform specific code that a new connection is established and new sockets are necessary
\item \-Receive implicit connected data on a receiving \-U\-D\-P socket\par
 \-The received data has to be hand over to the \-Connection \-Manager \-Object with the function \-E\-I\-P\-\_\-\-S\-T\-A\-T\-U\-S \-Handle\-Received\-Connected\-Data(\-E\-I\-P\-\_\-\-U\-I\-N\-T8 $\ast$data, int data\-\_\-length)
\item \-Close \-U\-D\-P and \-T\-C\-P sockets\-:
\begin{DoxyEnumerate}
\item \-Requested by \-Op\-E\-Ner through the call back function\-: void \hyperlink{group__CIP__CALLBACK__API_ga89293c1274a9092dec6be806b8d0779f}{\-Close\-Socket(int socket\-\_\-handle)}
\item \-For \-T\-C\-P connection when the peer closed the connection \-Op\-E\-Ner needs to be informed to clean up internal data structures. \-This is done with the function void \hyperlink{group__CIP__API_gab9ff230d61fc6dedd90f8b95e9a27707}{\-Close\-Session(int socket\-\_\-handle)}.
\end{DoxyEnumerate}
\item \-Cyclically update the connection status\-:\par
 \-In order that \-Op\-E\-Ner can determine when to produce new data on connections or that a connection timed out every \-O\-P\-E\-N\-E\-R\-\_\-\-T\-I\-M\-E\-R\-\_\-\-T\-I\-C\-K milliseconds the function \-E\-I\-P\-\_\-\-S\-T\-A\-T\-U\-S \-Manage\-Connections(void) has to be called.
\end{DoxyItemize}\hypertarget{dc/dcb/porting_callback_funcs_sec}{}\section{\-Callback Functions}\label{dc/dcb/porting_callback_funcs_sec}
\-In order to make \-Op\-E\-Ner more platform independent and in order to inform the application on certain state changes and actions within the stack a set of call-\/back functions is provided. \-These call-\/back functions are declared in the file \hyperlink{opener__api_8h}{opener\-\_\-api.\-h} and have to be implemented by the application specific code. \-An overview and explanation of \-Op\-E\-Ner's call-\/back \-A\-P\-I may be found in the module \hyperlink{group__CIP__CALLBACK__API}{\-Callback \-Functions \-Demanded by \-Op\-E\-Ner}. 